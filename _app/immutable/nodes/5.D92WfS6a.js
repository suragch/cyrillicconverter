import{f as p,a,c as C}from"../chunks/Y1qfGezR.js";import{i as V}from"../chunks/DN6SW8RB.js";import{p as X,Y as Z,e as tt,f as v,i as s,c as e,m as M,r,b as f,af as L,k as R}from"../chunks/BuRW4a-I.js";import{s as b,e as D}from"../chunks/FIFTuy36.js";import{i as S}from"../chunks/DWZ7psrM.js";import{e as et}from"../chunks/D-D9Z2yP.js";import{a as rt}from"../chunks/DfI3WDSR.js";var at=p("<p>Loading submissions...</p>"),st=p('<p class="error"> </p>'),ot=p("<p>No pending submissions to review. Great job!</p>"),it=p('<tr><td class="svelte-1cfidl9"> </td><td class="svelte-1cfidl9"> </td><td class="context svelte-1cfidl9"> </td><td class="actions svelte-1cfidl9"><button class="approve svelte-1cfidl9">Approve</button> <button class="reject svelte-1cfidl9">Reject</button></td></tr>'),nt=p('<table class="svelte-1cfidl9"><thead><tr><th class="svelte-1cfidl9">Cyrillic Word</th><th class="svelte-1cfidl9">Proposed Traditional</th><th class="svelte-1cfidl9">Context</th><th class="svelte-1cfidl9">Actions</th></tr></thead><tbody></tbody></table>'),lt=p('<div class="dashboard"><h1>Moderation Dashboard</h1> <p>Review new community submissions for Traditional Mongolian conversions.</p> <!></div>');function mt(F,G){X(G,!1);let u=M([]),g=M(!0),_=M(null),o=null;rt.subscribe(t=>{o=t?.token??null});async function N(){if(o){f(g,!0),f(_,null);try{const t=await fetch("/api/moderation/conversions/pending",{headers:{Authorization:`Bearer ${o}`}});if(!t.ok)throw new Error(`Failed to fetch: ${t.statusText}`);f(u,await t.json())}catch(t){f(_,t.message)}finally{f(g,!1)}}}Z(()=>{o&&N()});async function P(t,i){if(o)try{const n=await fetch(`/api/moderation/conversion/${t}/${i}`,{method:"POST",headers:{Authorization:`Bearer ${o}`}});if(!n.ok)throw new Error(`Action failed: ${n.statusText}`);f(u,e(u).filter(x=>x.conversion_id!==t))}catch(n){alert(`Error: ${n.message}`)}}V();var w=lt(),O=v(s(w),4);{var W=t=>{var i=at();a(t,i)},Y=t=>{var i=C(),n=L(i);{var x=l=>{var c=st(),y=s(c);r(c),R(()=>b(y,`Error: ${e(_)??""}`)),a(l,c)},q=l=>{var c=C(),y=L(c);{var H=d=>{var h=ot();a(d,h)},I=d=>{var h=nt(),$=v(s(h));et($,5,()=>e(u),k=>k.conversion_id,(k,m)=>{var A=it(),j=s(A),J=s(j,!0);r(j);var T=v(j),K=s(T,!0);r(T);var E=v(T),Q=s(E);r(E);var z=v(E),B=s(z),U=v(B,2);r(z),r(A),R(()=>{b(J,e(m).cyrillic_word),b(K,e(m).traditional),b(Q,`"${e(m).context??""}"`)}),D("click",B,()=>P(e(m).conversion_id,"approve")),D("click",U,()=>P(e(m).conversion_id,"reject")),a(k,A)}),r($),r(h),a(d,h)};S(y,d=>{e(u).length===0?d(H):d(I,!1)},!0)}a(l,c)};S(n,l=>{e(_)?l(x):l(q,!1)},!0)}a(t,i)};S(O,t=>{e(g)?t(W):t(Y,!1)})}r(w),a(F,w),tt()}export{mt as component};
